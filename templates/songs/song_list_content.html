{% load session_filters %}
{% load thumbnail %}

{% for song, score in page_obj %}
            <div class="container-fluid p-0 mt-1">
                <div class="row justify-content-between align-items-center bg-dark p-2 shadow rounded-2" style="border: 1px solid hsla(0, 0%, 100%, .3);">
                    {% thumbnail song.thumbnail "70x70" crop="center" as thumb %}
                        <a href="{% url 'songs:song_detail' song.id %}" style="padding: 0; display: inline; width: 70px;"><img src="{{ thumb.url }}" alt="" style="width: 70px; height: 70px; padding: 0;"></a>
                    {% endthumbnail %}
                    <div class="col">
                        <span class="text-white" style="margin-right: 2px;">{{ page_obj.start_index|add:forloop.counter0 }}</span>
                        <span class="text-white ">ìœ„</span> 
                        {% if score >= 50 %}
                            <span style="color: deeppink;">Hot!</span>    
                        {% elif score < 50 and score >= 20 %}
                            <span style="color: aquamarine;">Recommended!!!</span>
                        {% endif %}
                        <a class="text-decoration-none " href="{% url 'songs:song_detail' song.id %}">
                            <!-- ë…¸ë˜ ì„¸ë¶€ ë‚´ìš© í˜ì´ì§€ë¡œ ë§í¬ -->
                            <h5 class="text-white mb-0">{{ song.title }}</h5>
                            <small class="fs-6" style="color: #888888;">
                                <a class="text-decoration-none " style="color: #888;" href="{% url 'sellers:seller_artist' song.seller.user.id %}">{{ song.seller }}</a>
                            </small>
                        </a>
                    </div>
                    <div class="col-auto d-flex align-items-center">
                        <audio controls class="me-0" controlsList="nodownload">
                            <source src="{{ song.mp3.url }}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                        {% if user.is_authenticated %}
                        <!-- ì—¬ê¸°ì„œ templatetags ë¡œ song.idë¥¼ ë„˜ê²¨ì„œ êµ¬ë§¤í•œ ë…¸ë˜ì¸ì§€ ì•„ë‹Œ ì§€ í™•ì¸ í•˜ëŠ” ê±°ë¥¼ ì²´í¬-->
                            {% is_purchased user song.id as purchased %}
                            {% is_added_to_cart user song.id as added %}
                            {% if not added %}
                                <button id="add-btn-{{song.id}}" type="button" class="btn btn" onclick="addToCart('{{song.id}}');">ğŸ¤</button>
                                <a class="btn btn" style="cursor: pointer;" data-id="{{ song.id }}" onclick="showLyrics('{{ song.id }}')">ğŸ“ƒ</a>
                            {% else %}
                                <button id="remove-btn-{{song.id}}" type="button" class="btn btn" onclick="removeFromCart('{{song.id}}');">â¤ï¸</button>
                                <a class="btn btn" style="cursor: pointer;" data-id="{{ song.id }}" onclick="showLyrics('{{ song.id }}')">ğŸ“ƒ</a>
                            {% endif %}
                            {% if not purchased %}
                                <form action="{% url 'payments:payment_pay' song.id %}" onsubmit="return confirmPurchase('{{ song.title|escapejs }}')">
                                    <button class="btn btn" type="submit" onclick="">ğŸ’³</button>
                                </form>
                            {% else %}
                                <a href="{{ song.mp3.url }}" download="{{ song.title }}.mp3">
                                    <button class="btn btn">ğŸ’¾</button>
                                </a>
                            {% endif %}
                        {% else %}
                            <button type="button" class="btn btn" onclick="gotoLogin();">ğŸ¤</button>
                            <button class="btn btn" type="submit" onclick="gotoLogin();">ğŸ’³</button>
                            <a class="btn btn" style="cursor: pointer;" data-id="{{ song.id }}" onclick="showLyrics('{{ song.id }}')">ğŸ“ƒ</a>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
